<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="iEnergy contacts list" />
  <title>iEnergy | Contacts List</title>
  <link rel="stylesheet" href="../home.css?v=2" />
  <style>
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end; }
    .field { flex: 1 1 320px; }
    label { display:block; margin: 0 0 6px; color: rgba(233,238,252,0.80); font-size: 13px; }
    input[type="text"] {
      width: 100%;
      padding: 11px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.03);
      color: var(--text);
      outline: none;
    }
    input[type="text"]:focus { border-color: rgba(47,107,255,0.60); }
    .btn {
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 11px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      cursor: pointer;
      font-weight: 700;
      text-decoration: none;
    }
    .cards { margin-top: 14px; display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px; }
    @media (max-width: 760px) { .cards { grid-template-columns: 1fr; } }
    .card {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 14px;
      background: rgba(255,255,255,0.03);
    }
    .card h3 { margin: 0 0 6px; font-size: 15px; }
    .meta { color: rgba(233,238,252,0.75); font-size: 13px; line-height: 1.5; }
    .meta a { color: rgba(233,238,252,0.92); text-decoration: none; }
    .meta a:hover { text-decoration: underline; }
    .note { margin: 10px 0 0; color: var(--muted); font-size: 12.5px; line-height: 1.45; }
  </style>
  <script defer src="../auth.js"></script>
</head>
<body data-app-key="contacts-list" data-app-password="iEnergycontact">
  <main class="container">
    <header class="hero">
      <div class="hero-text">
        <div class="pill">Directory</div>
        <h1>Contacts List</h1>
        <p class="tagline">Internal contacts and support directory.</p>
        <p style="margin:12px 0 0;"><a class="btn" href="../index.html">← Back to Home</a></p>
      </div>
      <img class="hero-logo" src="../logo.jpg" alt="iEnergy logo" />
    </header>

    

    <section class="section" id="lockScreen" style="display:none;">
      <div class="lock-box">
        <div class="pill">Restricted Access</div>
        <h2 class="lock-title">Password Required</h2>
        <p class="lock-sub">Enter the application password to continue. Access stays unlocked for 10 minutes.</p>
        <div class="lock-form">
          <div class="lock-field">
            <label for="passwordInput">Password</label>
            <input id="passwordInput" class="lock-input" type="password" autocomplete="off" placeholder="Enter password" />
          </div>
          <button id="unlockBtn" class="lock-btn" type="button">Unlock</button>
        </div>
        <div id="lockMsg" class="lock-msg" style="display:none;"></div>
      </div>
    </section>

    <div id="protectedContent" style="display:none;"><section class="section">
      <h2>Search</h2>
      <p class="section-sub">Filter by name, department, or keyword.</p>

      <div class="row">
        <div class="field">
          <label for="q">Search</label>
          <input id="q" type="text" autocomplete="off" placeholder="e.g., HR, payroll, IT" />
        </div>
      </div>

      <div id="cards" class="cards"></div>
      <p class="note">To update this page, edit <code>contacts-list/index.html</code> and update the <code>CONTACTS</code> array.</p>
    </section>
    </div>


    <footer class="footer">
      <small>© <span id="year"></span> iEnergy. Internal use.</small>
    </footer>
  </main>

  <script>
    document.getElementById('year').textContent = String(new Date().getFullYear());

    // Update these values to match your internal directory
    const CONTACTS = [
      { name: 'Payroll Support', dept: 'HR / Payroll', phone: '', email: 'payroll@ienergy.local', notes: 'Salary slips, deductions, social insurance.' },
      { name: 'HR Office', dept: 'Human Resources', phone: '', email: 'hr@ienergy.local', notes: 'Hiring, leave, contracts, HR letters.' },
      { name: 'IT Helpdesk', dept: 'IT', phone: '', email: 'it@ienergy.local', notes: 'Accounts, devices, access to tools.' },
    ];

    const cardsEl = document.getElementById('cards');
    const qEl = document.getElementById('q');

    function escapeHtml(s) {
      return String(s ?? '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    function render() {
      const q = String(qEl.value ?? '').trim().toLowerCase();
      const filtered = CONTACTS.filter(c => {
        if (!q) return true;
        const hay = [c.name, c.dept, c.phone, c.email, c.notes].join(' | ').toLowerCase();
        return hay.includes(q);
      });

      cardsEl.innerHTML = filtered.map(c => {
        const phone = c.phone ? `<div>Phone: <a href="tel:${escapeHtml(c.phone)}">${escapeHtml(c.phone)}</a></div>` : '';
        const email = c.email ? `<div>Email: <a href="mailto:${escapeHtml(c.email)}">${escapeHtml(c.email)}</a></div>` : '';
        const notes = c.notes ? `<div>${escapeHtml(c.notes)}</div>` : '';

        return `
          <div class="card">
            <h3>${escapeHtml(c.name)}</h3>
            <div class="meta">
              <div>Department: ${escapeHtml(c.dept || '-')}</div>
              ${phone}
              ${email}
              ${notes}
            </div>
          </div>
        `;
      }).join('') || '<div class="note">No contacts match your search.</div>';
    }

    qEl.addEventListener('input', render);
    render();
  </script>
</body>
</html>
